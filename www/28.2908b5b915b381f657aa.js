(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{yPrK:function(t,n,e){"use strict";e.r(n),e.d(n,"SettingsPageModule",(function(){return y}));var o=e("Valr"),i=e("QJY3"),a=e("DUip"),r=e("sPEm"),c=e("wd/R"),s=e("TYT/"),l=e("aaed"),b=e("c7H9"),u=e("ri4K"),p=e("m/P+"),m=function(){return["/manage-users/"]},h=function(){return["/manage-payments/"]};function d(t,n){1&t&&(s.Mb(0,"div"),s.Mb(1,"ion-list-header"),s.lc(2,"Admin"),s.Lb(),s.Mb(3,"ion-item",8),s.Kb(4,"ion-icon",17),s.Mb(5,"ion-label"),s.Mb(6,"h2"),s.lc(7,"Manage Users"),s.Lb(),s.Mb(8,"p"),s.lc(9,"Verify new users of the app"),s.Lb(),s.Lb(),s.Lb(),s.Mb(10,"ion-item",8),s.Kb(11,"ion-icon",18),s.Mb(12,"ion-label"),s.Mb(13,"h2"),s.lc(14,"Manage Payments"),s.Lb(),s.Mb(15,"p"),s.lc(16,"View upcoming payments and generate bank payment file"),s.Lb(),s.Lb(),s.Lb(),s.Lb()),2&t&&(s.zb(3),s.bc("routerLink",s.cc(2,m)),s.zb(7),s.bc("routerLink",s.cc(3,h)))}var f=function(){return["/billing/"]},g=[{path:"",component:function(){function t(t,n,e,o,i,a){var r=this;this.emailComposer=t,this.plt=n,this.profileService=e,this.authenticationService=o,this.alertCtrl=i,this.iab=a,this.user={},this.authenticationService.getUserData().subscribe((function(t){r.user=t})),this.paymentTotal=0}return t.prototype.ngOnInit=function(){},t.prototype.ionViewDidEnter=function(){this.getPaymentTotal()},t.prototype.getBankAccount=function(){return this.user.profile&&this.user.profile.bank_account?this.user.profile.bank_account.replace(/(\+?\d{3})(\d+)(\d{2})/g,(function(t,n,e,o){return n+"*".repeat(e.length)+o})):"No bank account set"},t.prototype.getPaymentTotal=function(){var t=this;this.authenticationService.getPaymentTotal().then((function(n){t.paymentTotal=n}))},t.prototype.getNextPaymentDate=function(){return c().add(1,"months").startOf("month").format("DD/MM/YYYY")},t.prototype.openRate=function(){this.plt.is("ios")?this.iab.create("https://apps.apple.com/app/","_system"):this.iab.create("https://play.google.com/store/apps/details?id=com.musicbuddy.app","_system")},t.prototype.openFollow=function(){this.iab.create("https://www.facebook.com/musicbuddynz","_system")},t.prototype.openEmail=function(){this.emailComposer.open({to:["musicbuddynz@gmail.com"],subject:"Subject for your support query",body:"Provide details about the support you require.",isHtml:!0})},t.prototype.openChangeBankAccount=function(){var t=this;this.alertCtrl.create({header:"Change Bank Account",inputs:[{name:"bank_account",placeholder:"Bank Account Number",type:"number"}],buttons:[{text:"Cancel",role:"cancel",handler:function(t){}},{text:"Change",handler:function(n){if(n.bank_account){var e={bank_account:n.bank_account,user_id:t.user.id};t.user.profile.bank_account=n.bank_account,t.profileService.updateProfile(e).then((function(){}))}}}]}).then((function(t){t.present()}))},t.prototype.openChangePassword=function(){var t=this;this.alertCtrl.create({header:"Change Password",inputs:[{name:"password",placeholder:"Password",type:"password"},{name:"confirmPassword",placeholder:"Confirm Password",type:"password"}],buttons:[{text:"Cancel",role:"cancel",handler:function(t){}},{text:"Change",handler:function(n){n.password&&n.confirmPassword&&n.password===n.confirmPassword?t.authenticationService.changePassword(t.user.email,n.password,n.confirmPassword).then((function(){t.alertCtrl.create({header:"Success",message:"Your password has been updated",buttons:[{text:"Dismiss",role:"cancel",handler:function(t){}}]}).then((function(t){t.present()}))})).catch((function(){t.alertCtrl.create({header:"Error",message:"There was an error while changing your password.",buttons:[{text:"Cancel",role:"cancel",handler:function(t){}},{text:"Try Again",handler:function(n){setTimeout((function(){t.openChangePassword()}),200)}}]}).then((function(t){t.present()}))})):t.alertCtrl.create({header:"Error",message:"Passwords do not match",buttons:[{text:"Cancel",role:"cancel",handler:function(t){}},{text:"Try Again",handler:function(n){setTimeout((function(){t.openChangePassword()}),200)}}]}).then((function(t){t.present()}))}}]}).then((function(t){t.present()}))},t.prototype.changeView=function(t){},t.prototype.logout=function(){this.authenticationService.logout()},t.\u0275fac=function(n){return new(n||t)(s.Jb(l.a),s.Jb(r.W),s.Jb(b.a),s.Jb(u.a),s.Jb(r.a),s.Jb(p.a))},t.\u0275cmp=s.Db({type:t,selectors:[["app-settings"]],decls:62,vars:9,consts:[["slot","start"],["defaultHref","/tabs/profile"],[1,"settings-list"],[4,"ngIf"],[1,"settings-list__payment"],["name","cash","slot","start","color","primary"],["name","wallet-outline","slot","start","color","primary"],["slot","end","fill","outline",3,"click"],["routerDirection","forward",1,"settings-list__payment",3,"routerLink"],["name","document-text-outline","slot","start","color","primary"],["name","heart-outline","slot","start","color","primary"],["name","logo-facebook","slot","start","color","primary"],["name","mail-outline","slot","start","color","primary"],["detail","",3,"click"],["name","lock-open-outline","slot","start","color","primary"],[3,"click"],["name","lock-closed-outline","slot","start","color","primary"],["name","people","slot","start"],["name","card","slot","start"]],template:function(t,n){1&t&&(s.Mb(0,"ion-header"),s.Mb(1,"ion-toolbar"),s.Mb(2,"ion-buttons",0),s.Mb(3,"ion-button"),s.Kb(4,"ion-back-button",1),s.Lb(),s.Lb(),s.Mb(5,"ion-title"),s.lc(6,"Settings"),s.Lb(),s.Lb(),s.Lb(),s.Mb(7,"ion-content"),s.Mb(8,"ion-list",2),s.kc(9,d,17,4,"div",3),s.Mb(10,"ion-list-header"),s.lc(11,"Balance"),s.Lb(),s.Mb(12,"ion-item",4),s.Kb(13,"ion-icon",5),s.Mb(14,"ion-label"),s.Mb(15,"h2"),s.lc(16),s.Xb(17,"number"),s.Lb(),s.Mb(18,"p"),s.lc(19),s.Lb(),s.Lb(),s.Lb(),s.Mb(20,"ion-item",4),s.Kb(21,"ion-icon",6),s.Mb(22,"ion-label"),s.Mb(23,"h2"),s.lc(24,"Bank Account"),s.Lb(),s.Mb(25,"p"),s.lc(26),s.Lb(),s.Lb(),s.Mb(27,"ion-button",7),s.Ub("click",(function(){return n.openChangeBankAccount()})),s.lc(28,"Change"),s.Lb(),s.Lb(),s.Mb(29,"ion-item",8),s.Kb(30,"ion-icon",9),s.Mb(31,"ion-label"),s.Mb(32,"h2"),s.lc(33,"Billing & Payments"),s.Lb(),s.Mb(34,"p"),s.lc(35,"View all billing and payments you have made through the app"),s.Lb(),s.Lb(),s.Lb(),s.Mb(36,"ion-list-header"),s.lc(37,"Support"),s.Lb(),s.Mb(38,"ion-item"),s.Kb(39,"ion-icon",10),s.lc(40," Rate The App "),s.Mb(41,"ion-button",7),s.Ub("click",(function(){return n.openRate()})),s.lc(42,"Rate"),s.Lb(),s.Lb(),s.Mb(43,"ion-item"),s.Kb(44,"ion-icon",11),s.lc(45," Follow Us "),s.Mb(46,"ion-button",7),s.Ub("click",(function(){return n.openFollow()})),s.lc(47,"Follow"),s.Lb(),s.Lb(),s.Mb(48,"ion-item"),s.Kb(49,"ion-icon",12),s.lc(50," Contact Support "),s.Mb(51,"ion-button",7),s.Ub("click",(function(){return n.openEmail()})),s.lc(52,"Email"),s.Lb(),s.Lb(),s.Mb(53,"ion-list-header"),s.lc(54,"Account Settings"),s.Lb(),s.Mb(55,"ion-item",13),s.Ub("click",(function(){return n.openChangePassword()})),s.Kb(56,"ion-icon",14),s.Mb(57,"ion-label"),s.lc(58,"Change Password"),s.Lb(),s.Lb(),s.Mb(59,"ion-item",15),s.Ub("click",(function(){return n.logout()})),s.Kb(60,"ion-icon",16),s.lc(61," Logout "),s.Lb(),s.Lb(),s.Lb()),2&t&&(s.zb(9),s.bc("ngIf","admin"===n.user.permission),s.zb(7),s.nc("$",s.Yb(17,5,n.paymentTotal,"1.2-2"),""),s.zb(3),s.nc("Next payment ",n.getNextPaymentDate(),""),s.zb(7),s.mc(n.getBankAccount()),s.zb(3),s.bc("routerLink",s.cc(8,f)))},directives:[r.q,r.O,r.i,r.h,r.e,r.f,r.N,r.n,r.x,o.k,r.y,r.v,r.r,r.w,r.X,a.h],pipes:[o.d],styles:[".settings-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{margin-bottom:10px;margin-top:20px;padding-top:10px}.settings-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]:first-child{margin-top:0;padding-top:0}.settings-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:0}.settings-list[_ngcontent-%COMP%]   ion-icon[name=logo-facebook][_ngcontent-%COMP%]{color:#1778f2}"]}),t}()}],y=function(){function t(){}return t.\u0275mod=s.Hb({type:t}),t.\u0275inj=s.Gb({factory:function(n){return new(n||t)},imports:[[o.b,i.a,r.P,a.j.forChild(g)]]}),t}()}}]);